doctype html
html
    head
        meta(charset = 'utf-8')
        script(src='//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js')
        //- script(src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js')
        script(src='https://code.jquery.com/ui/1.12.1/jquery-ui.js')
        link(rel='stylesheet', href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css')
        link(rel='stylesheet' href='//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css')
        link(rel='stylesheet' href='https://fonts.googleapis.com/css?family=Nanum+Gothic') 
        link(rel='stylesheet' href='https://use.fontawesome.com/releases/v5.7.1/css/all.css' integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous")
        link(rel="stylesheet", href="css/common.css")
        link(rel="stylesheet", href="css/expense.css")

        script(src="https://www.amcharts.com/lib/4/core.js")
        script(src="https://www.amcharts.com/lib/4/charts.js")
        //- script(src="https://www.amcharts.com/lib/4/themes/spiritedaway.js")
        script(src="https://www.amcharts.com/lib/4/themes/material.js")
        script(src="https://www.amcharts.com/lib/4/themes/animated.js")


        script(type='text/javascript' src='js/common.js') 
        script(type='text/javascript' src='js/expenseStatistics.js') 

        style.
            #chartdiv, #partnerChartdiv{
                height: 350px;
                position: relative;
                width: calc(50% - 10px);
                top: 100px;
                display: inline-block;
                left: 0px;
            }
        script.
            

            am4core.ready(function() {

                // Themes begin
                am4core.useTheme(am4themes_material);
                am4core.useTheme(am4themes_animated);
                // Themes end

                // Create chart instance
                var chart = am4core.create("partnerChartdiv", am4charts.PieChart);

                // Add and configure Series
                var pieSeries = chart.series.push(new am4charts.PieSeries());
                
                pieSeries.dataFields.value = "litres";
                pieSeries.dataFields.category = "country";

                // Let's cut a hole in our Pie chart the size of 30% the radius
                chart.innerRadius = am4core.percent(40);

                // Put a thick white border around each Slice
                pieSeries.slices.template.stroke = am4core.color("#fff");
                pieSeries.slices.template.strokeWidth = 2;
                pieSeries.slices.template.strokeOpacity = 1;
                pieSeries.slices.template
                // change the cursor on hover to make it apparent the object can be interacted with
                .cursorOverStyle = [
                    {
                    "property": "cursor",
                    "value": "pointer"
                    }
                ];

                pieSeries.alignLabels = false;
                //- pieSeries.labels.template.bent = true;
                //- pieSeries.labels.template.radius = 3;
                //- pieSeries.labels.template.padding(0,0,0,0);

                pieSeries.ticks.template.disabled = true;

                pieSeries.labels.template.text = "{category}";
                pieSeries.labels.template.radius = am4core.percent(-25);
                pieSeries.labels.template.fill = am4core.color("white");

                pieSeries.labels.template.adapter.add("radius", function(radius, target) {
                    if (target.dataItem && (target.dataItem.values.value.percent < 10)) {
                        return 0;
                    }
                    return radius;
                    });

                pieSeries.labels.template.adapter.add("fill", function(color, target) {
                    if (target.dataItem && (target.dataItem.values.value.percent < 10)) {
                        return am4core.color("#000");
                    }
                    return color;
                });

                pieSeries.labels.template.adapter.add("hidden", function(color, target) {
                    return target.dataItem.values.value.percent < 5 ? true : false;
                });

                
                pieSeries.slices.template.tooltipText = "{value.value} ({value.percent.formatNumber('#.0')}%)";

                // Create a base filter effect (as if it's not there) for the hover to return to
                var shadow = pieSeries.slices.template.filters.push(new am4core.DropShadowFilter);
                shadow.opacity = 0;

                // Create hover state
                var hoverState = pieSeries.slices.template.states.getKey("hover"); // normally we have to create the hover state, in this case it already exists

                // Slightly shift the shadow and make it more prominent on hover
                var hoverShadow = hoverState.filters.push(new am4core.DropShadowFilter);
                hoverShadow.opacity = 0.7;
                hoverShadow.blur = 5;

                // Add a legend
                //- chart.legend = new am4charts.Legend();
                chart.fontSize = 10;

                chart.data = [{
                "country": "Lithuania",
                "litres": 500000
                },{
                "country": "Germany",
                "litres": 165000
                }, {
                "country": "Australia",
                "litres": 139000
                }, {
                "country": "Austria",
                "litres": 128000
                }, {
                "country": "UK",
                "litres": 99000
                }, {
                "country": "Belgium",
                "litres": 60000
                }, {
                "country": "test",
                "litres": 1000
                }];

                let label = pieSeries.createChild(am4core.Label);
                label.text = "Hi there!";
                label.horizontalCenter = "middle";
                label.verticalCenter = "middle";
                label.fontSize = 20;
            }); // end am4core.ready()
    body
        div(class='container')
            div(class="left" style="background-color:#282c2f;")
                div(class="header")
                    span(class="skyBlue emailInfo") #{email}
                    span(class="sub white") 
                        span(class="logout") 
                            i(class='fas fa-sign-out-alt')
                div
                    ul(class="menuNavi")
                        li
                            a(href='/list')
                                i(class="far fa-angry")
                                span DAILY
                        li
                            a(href='/todolist')
                                i(class="far fa-grin-squint-tears")
                                span TO DO
                        li
                            a(href='/budget')
                                i(class="far fa-smile")
                                span BUDGET

                        li(class='active')
                            a(href='/statistics')
                                i(class="far fa-grin-beam-sweat")
                                span EXPENSE
                        li
                            a(href='/setting')
                                i(class="fas fa-cogs")
                                span SETTING

            div(class='center' style='background:#fafafa;')
                header(class="header backWhite")
                    span(class="first") Expense Statistics
                    ul(class="nav nav-pills")
                        li(role="presentation" class="active")
                            a(href="#") 요약
                        li(role="presentation")
                            a(href="/expense") 내 사용내역
                        li(role="presentation")
                            a(href="/partnerExpense") 파트너 내역

                div(id="chartdiv")
                div(id="partnerChartdiv")